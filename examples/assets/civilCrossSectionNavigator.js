import{C as M,L as v}from"./web-ifc-api-Dxv4iFj4.js";import{C as x,T as B,e as E,_ as S,O as k,a as A,x as C}from"./index-BRzxhLMM.js";import{T as D}from"./index-DtbylpTq.js";import{v as T}from"./index-COjhB_AQ.js";import{S as I}from"./stats.min-DYv0AsOH.js";import{n as L,i as _,r as P,o as U,A as j}from"./index-CnRcHl0y.js";D.init();T.init();const y=document.getElementById("container"),e=new x,H=e.get(B),t=H.create();t.scene=new E(e);t.renderer=new L(e,y);t.camera=new S(e);e.init();t.scene.setup();t.camera.controls.setLookAt(5,5,5,0,0,0);y.appendChild(t.renderer.three2D.domElement);const N=e.get(k);N.create(t);t.scene.three.background=null;const b=e.get(A),O=await fetch("https://thatopen.github.io/engine_components/resources/road.frag"),W=await O.arrayBuffer(),z=new Uint8Array(W),d=b.load(z);t.scene.three.add(d);const F=await fetch("https://thatopen.github.io/engine_components/resources/road.json");d.setLocalProperties(await F.json());const f=document.getElementById("scene-2d-left");f.components=e;if(!f.world)throw new Error("World not found!");const c=e.get(_);c.world=f.world;await c.draw(d);const l=e.get(P);l.world=t;l.draw(d);const g=document.getElementById("scene-2d-right");g.components=e;if(!g.world)throw new Error("World not found!");const h=e.get(U);h.world=g.world;h.world3D=t;c.onMarkerChange.add(({alignment:o,percentage:n,type:r,curve:s})=>{if(l.setMarker(o,n,r),r==="select"){const i=s.alignment.absolute[s.index].mesh,m=o.getPointAt(n,"absolute");h.set(i,m)}});c.onHighlight.add(({mesh:o})=>{l.highlighter.select(o);const n=o.curve.index,r=o.curve.alignment.absolute[n];r.mesh.geometry.computeBoundingSphere();const s=r.mesh.geometry.boundingSphere;s&&t.camera.controls.fitToSphere(s,!0)});c.onMarkerHidden.add(({type:o})=>{l.hideMarker(o)});const w=e.get(C);w.byEntity(d);const R=w.list,p=e.get(j),u=p.styles.list;for(const o in R.entities){const n=w.find({entities:[o]}),r=new M(Math.random(),Math.random(),Math.random()),s=new v({color:r});p.styles.create(o,new Set,g.world,s);for(const i in n){const m=b.list.get(i);m&&(u[o].fragments[i]=new Set(n[i]),u[o].meshes.add(m.mesh))}}p.update(!0);const a=new I;a.showPanel(2);document.body.append(a.dom);a.dom.style.left="0px";a.dom.style.zIndex="unset";t.renderer.onBeforeUpdate.add(()=>a.begin());t.renderer.onAfterUpdate.add(()=>a.end());
